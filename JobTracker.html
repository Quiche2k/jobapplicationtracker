<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Application Tracker</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        /* Custom styles for Status dropdown to make it look nicer */
        .status-select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='none' stroke='%23374151'%3e%3cpath d='M7 7l3-3 3 3m0 6l-3 3-3-3' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1.5em 1.5em;
        }
        /* Status color indicators */
        .status-Applied { background-color: #dbeafe; color: #1d4ed8; font-weight: 500; }
        .status-InterviewScheduled { background-color: #fef3c7; color: #b45309; font-weight: 500; }
        .status-OfferReceived { background-color: #d1fae5; color: #065f46; font-weight: 600; }
        .status-Rejected { background-color: #fee2e2; color: #991b1b; font-weight: 500; }
        .status-Withdrawn { background-color: #e5e7eb; color: #4b5563; font-weight: 500; }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div class="max-w-7xl mx-auto bg-white shadow-xl rounded-xl p-6 lg:p-10">
        <h1 class="text-3xl font-bold text-gray-900 mb-6 border-b pb-2">Application Tracker Dashboard</h1>
        
        <!-- Application Form -->
        <div class="mb-8 p-6 bg-indigo-50 rounded-lg shadow-inner">
            <h2 class="text-xl font-semibold text-indigo-800 mb-4">Add New Application</h2>
            <form id="application-form" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
                
                <input type="text" id="job-title" placeholder="Job Title" required class="p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
                
                <input type="text" id="company-name" placeholder="Company/Org" required class="p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
                
                <div>
                    <label for="closing-date" class="block text-xs font-medium text-gray-700 mb-1">Closing Date</label>
                    <input type="date" id="closing-date" required class="p-3 w-full border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                
                <div>
                    <label for="date-applied" class="block text-xs font-medium text-gray-700 mb-1">Date Applied</label>
                    <input type="date" id="date-applied" required class="p-3 w-full border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
                </div>

                <input type="url" id="job-link" placeholder="Job Link (Optional)" class="p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">

                <button type="submit" class="md:col-span-3 lg:col-span-5 bg-indigo-600 text-white p-3 rounded-lg font-semibold hover:bg-indigo-700 transition duration-150 shadow-md">
                    Add Application
                </button>
            </form>
        </div>

        <!-- Applications Table -->
        <h2 class="text-xl font-semibold text-gray-700 mb-4">Tracking List (<span id="application-count">0</span> Total)</h2>
        <div class="overflow-x-auto shadow-lg rounded-lg">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-indigo-600 text-white">
                    <tr>
                        <th class="px-3 py-2 text-left text-sm font-medium tracking-wider">Job Title / Company</th>
                        <th class="px-3 py-2 text-left text-sm font-medium tracking-wider">Applied / Closing Date</th>
                        <th class="px-3 py-2 text-left text-sm font-medium tracking-wider w-40">Progress/Status</th>
                        <th class="px-3 py-2 text-left text-sm font-medium tracking-wider">Link</th>
                        <th class="px-3 py-2 text-left text-sm font-medium tracking-wider w-20">Action</th>
                    </tr>
                </thead>
                <tbody id="application-table-body" class="bg-white divide-y divide-gray-100">
                    <!-- Application rows will be inserted here -->
                </tbody>
            </table>
        </div>

    </div>

    <script>
        const STORAGE_KEY = 'jobApplications';
        const form = document.getElementById('application-form');
        const tableBody = document.getElementById('application-table-body');
        const applicationCount = document.getElementById('application-count');
        
        let applications = [];

        // Helper function to load data from localStorage
        const loadApplications = () => {
            const data = localStorage.getItem(STORAGE_KEY);
            if (data) {
                applications = JSON.parse(data);
            } else {
                applications = [];
            }
            renderTable();
        };

        // Helper function to save data to localStorage
        const saveApplications = () => {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(applications));
            renderTable();
        };

        // Format date for display
        const formatDate = (dateString) => {
            const options = { month: 'short', day: 'numeric', year: 'numeric' };
            return new Date(dateString).toLocaleDateString(undefined, options);
        };

        // Render the table rows
        const renderTable = () => {
            // Sort applications by closing date (earliest first)
            applications.sort((a, b) => new Date(a.closingDate) - new Date(b.closingDate));
            
            tableBody.innerHTML = '';
            applicationCount.textContent = applications.length;

            if (applications.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="5" class="px-3 py-4 text-center text-gray-500 italic">No applications added yet. Start tracking your job search!</td>
                    </tr>
                `;
                return;
            }

            applications.forEach((app, index) => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 transition duration-100';
                
                const statusOptions = [
                    'Applied',
                    'Interview Scheduled',
                    'Offer Received',
                    'Rejected',
                    'Withdrawn'
                ];

                const linkHtml = app.jobLink ? 
                    `<a href="${app.jobLink}" target="_blank" class="text-indigo-600 hover:text-indigo-800 font-medium truncate inline-block max-w-full" title="${app.jobLink}">${app.jobLink.replace(/^https?:\/\//, '').split('/')[0]}</a>` :
                    `<span class="text-gray-400 italic">N/A</span>`;

                row.innerHTML = `
                    <td class="px-3 py-3 whitespace-nowrap">
                        <div class="text-sm font-semibold text-gray-900">${app.jobTitle}</div>
                        <div class="text-xs text-gray-500">${app.companyName}</div>
                    </td>
                    <td class="px-3 py-3 whitespace-nowrap text-sm text-gray-500">
                        <div class="text-xs font-medium text-gray-700">Applied: ${formatDate(app.dateApplied)}</div>
                        <div class="text-sm font-bold text-red-500">Close: ${formatDate(app.closingDate)}</div>
                    </td>
                    <td class="px-3 py-3 whitespace-nowrap">
                        <select 
                            data-index="${index}" 
                            class="status-select p-2 border border-gray-300 rounded-full text-xs status-${app.status.replace(/\s/g, '')}"
                            onchange="updateStatus(this)"
                        >
                            ${statusOptions.map(option => `
                                <option value="${option}" ${app.status === option ? 'selected' : ''}>${option}</option>
                            `).join('')}
                        </select>
                    </td>
                    <td class="px-3 py-3 text-sm text-gray-500 max-w-xs truncate">
                        ${linkHtml}
                    </td>
                    <td class="px-3 py-3 whitespace-nowrap">
                        <button onclick="deleteApplication(${index})" class="text-red-500 hover:text-red-700 transition duration-150 p-2 rounded-full hover:bg-red-100" title="Delete Application">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 10-2 0v6a1 1 0 102 0V8z" clip-rule="evenodd" />
                            </svg>
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        };

        // Handle form submission
        form.addEventListener('submit', (e) => {
            e.preventDefault();

            const newApp = {
                jobTitle: document.getElementById('job-title').value,
                companyName: document.getElementById('company-name').value,
                closingDate: document.getElementById('closing-date').value,
                dateApplied: document.getElementById('date-applied').value,
                jobLink: document.getElementById('job-link').value,
                status: 'Applied' // Default status
            };

            // Basic validation check
            if (new Date(newApp.closingDate) < new Date(newApp.dateApplied)) {
                alert("Closing Date cannot be before the Date Applied.");
                return;
            }

            applications.push(newApp);
            saveApplications();
            form.reset();
            // Automatically set Date Applied to today's date for next entry
            document.getElementById('date-applied').valueAsDate = new Date(); 
        });

        // Function to delete an application
        window.deleteApplication = (index) => {
            if (confirm(`Are you sure you want to delete the application for "${applications[index].jobTitle}"?`)) {
                applications.splice(index, 1);
                saveApplications();
            }
        };

        // Function to update status
        window.updateStatus = (selectElement) => {
            const index = selectElement.getAttribute('data-index');
            applications[index].status = selectElement.value;
            saveApplications();
        };

        // Load data on page load and pre-fill Date Applied
        window.onload = () => {
            loadApplications();
            document.getElementById('date-applied').valueAsDate = new Date();
        };
    </script>
</body>
</html>
